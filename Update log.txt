Date 6.30

Transfer some code From C to C++
